---

title: Shopping


keywords: fastai
sidebar: home_sidebar



nb_path: "shopping.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: shopping.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&#39;/home/ec2-user/SageMaker/stacks/villaEcommerceBackend/backend/thinClient&#39;,
 &#39;/home/ec2-user/SageMaker/.persisted_conda/python38/lib/python38.zip&#39;,
 &#39;/home/ec2-user/SageMaker/.persisted_conda/python38/lib/python3.8&#39;,
 &#39;/home/ec2-user/SageMaker/.persisted_conda/python38/lib/python3.8/lib-dynload&#39;,
 &#39;&#39;,
 &#39;/home/ec2-user/SageMaker/.persisted_conda/python38/lib/python3.8/site-packages&#39;,
 &#39;/home/ec2-user/SageMaker/.persisted_conda/python38/lib/python3.8/site-packages/IPython/extensions&#39;,
 &#39;/home/ec2-user/.ipython&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="browsing-Items">browsing Items<a class="anchor-link" href="#browsing-Items"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Browser" class="doc_header"><code>class</code> <code>Browser</code><a href="https://github.com/thanakijwanavit/linesdk/tree/master/villaThinClient/shopping.py#L20" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Browser</code>(<strong><code>searchEndpoint</code></strong>=<em><code>'https://8av9li9v82.execute-api.ap-southeast-1.amazonaws.com/Prod/orismaSearch/'</code></em>, <strong><code>branch</code></strong>=<em><code>'dev-manual'</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">browser</span> <span class="o">=</span> <span class="n">Browser</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Search-for-items">Search for items<a class="anchor-link" href="#Search-for-items"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nd">@add_method</span><span class="p">(</span><span class="n">Browser</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">search</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">searchQuery</span><span class="p">:</span><span class="nb">str</span><span class="p">)</span><span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
  <span class="n">endpoint</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">searchEndpoint</span>
  <span class="n">queries</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;data_t3&#39;</span><span class="p">:</span><span class="n">searchQuery</span>
  <span class="p">}</span>
  <span class="n">response</span> <span class="o">=</span> <span class="n">get</span><span class="p">(</span><span class="n">endpoint</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">queries</span><span class="p">)</span>
  <span class="n">result</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
  <span class="k">try</span><span class="p">:</span>
    <span class="n">resultList</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">result</span><span class="p">)[</span><span class="s1">&#39;pr_code&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
  <span class="k">except</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">resultList</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>
<span class="n">resultList</span> <span class="o">=</span> <span class="n">browser</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s1">&#39;rose&#39;</span><span class="p">)</span>
<span class="n">resultList</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>CPU times: user 15 ms, sys: 326 µs, total: 15.3 ms
Wall time: 1.1 s
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&#39;0193215&#39;,
 &#39;0205723&#39;,
 &#39;0177284&#39;,
 &#39;0158034&#39;,
 &#39;0214013&#39;,
 &#39;0176563&#39;,
 &#39;0139027&#39;,
 &#39;0230898&#39;,
 &#39;0175742&#39;,
 &#39;0171289&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="get-info-for-searched-item">get info for searched item<a class="anchor-link" href="#get-info-for-searched-item"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nd">@add_method</span><span class="p">(</span><span class="n">Browser</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">getProductInfo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">products</span><span class="p">:</span><span class="nb">list</span><span class="p">)</span><span class="o">-&gt;</span><span class="p">(</span><span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">],</span><span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">]):</span>
<span class="c1">#   products = []</span>
<span class="c1">#   errors = []</span>
  <span class="n">items</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">productSdk</span><span class="o">.</span><span class="n">queryList</span><span class="p">(</span><span class="n">products</span><span class="p">)</span>
<span class="c1">#   for result in resultList:</span>
<span class="c1">#     if (item := self.productSdk.(result)).get(&#39;error&#39;):</span>
<span class="c1">#       products.append(item)</span>
<span class="c1">#     else:</span>
<span class="c1">#       errors.append(result)</span>
  <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;found </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">items</span><span class="p">)</span><span class="si">}</span><span class="s1"> products out of </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">products</span><span class="p">)</span><span class="si">}</span><span class="s1"> products&#39;</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">items</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>
<span class="n">products</span> <span class="o">=</span> <span class="n">browser</span><span class="o">.</span><span class="n">getProductInfo</span><span class="p">(</span><span class="n">resultList</span><span class="p">)</span>
<span class="n">products</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>found 225 products out of 335 products
CPU times: user 14.5 ms, sys: 4.4 ms, total: 18.9 ms
Wall time: 4.19 s
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;0193215&#39;: {&#39;iprcode&#39;: &#39;0193215&#39;,
  &#39;cprcode&#39;: &#39;0193215&#39;,
  &#39;oprcode&#39;: &#39;0193215&#39;,
  &#39;ordertype&#39;: &#39;Y&#39;,
  &#39;pr_abb&#39;: &#39;ROSE SEESENCE BONBON&#39;,
  &#39;pr_active&#39;: &#39;Y&#39;,
  &#39;pr_cgcode&#39;: &#39;15&#39;,
  &#39;pr_code&#39;: &#39;0193215&#39;,
  &#39;pr_dpcode&#39;: &#39;19&#39;,
  &#39;pr_engname&#39;: &#39;ROSE SEESENCE BONBON&#39;,
  &#39;pr_ggcode&#39;: &#39;195&#39;,
  &#39;pr_market&#39;: &#39;บอล บอล กลิ่นกุหลาบ&#39;,
  &#39;pr_name&#39;: &#39;บอล บอล กลิ่นกุหลาบ&#39;,
  &#39;pr_puqty&#39;: &#39;1.00&#39;,
  &#39;pr_sa_method&#39;: &#39;1&#39;,
  &#39;pr_sucode1&#39;: &#39;CM1260&#39;,
  &#39;pr_suref3&#39;: &#39;A&#39;,
  &#39;prtype&#39;: &#39;I&#39;,
  &#39;psqty&#39;: &#39;1&#39;,
  &#39;pstype&#39;: &#39;1&#39;,
  &#39;pr_country_th&#39;: &#39;&#39;,
  &#39;pr_country_en&#39;: &#39;Thailand&#39;,
  &#39;pr_keyword_th&#39;: &#39;&#39;,
  &#39;pr_keyword_en&#39;: &#39;&#39;,
  &#39;pr_filter_th&#39;: &#39;&#39;,
  &#39;pr_filter_en&#39;: &#39;&#39;,
  &#39;online_category_l1_th&#39;: &#39;&#39;,
  &#39;online_category_l1_en&#39;: &#39;&#39;,
  &#39;online_category_l2_th&#39;: &#39;&#39;,
  &#39;online_category_l2_en&#39;: &#39;&#39;,
  &#39;online_category_l3_th&#39;: &#39;&#39;,
  &#39;online_category_l3_en&#39;: &#39;&#39;,
  &#39;villa_category_l1_en&#39;: &#39;Fresh&#39;,
  &#39;villa_category_l2_en&#39;: &#39;Fresh Produce&#39;,
  &#39;villa_category_l3_en&#39;: &#39;Bakery&#39;,
  &#39;villa_category_l4_en&#39;: &#39;Cake category&#39;,
  &#39;content_en&#39;: &#39;0193215 ROSE SEESENCE BONBON&#39;,
  &#39;content_th&#39;: &#39;ROSE SEESENCE BONBON&#39;,
  &#39;hema_brand_th&#39;: &#39;&#39;,
  &#39;hema_brand_en&#39;: &#39;&#39;,
  &#39;hema_sizedesc&#39;: &#39;&#39;,
  &#39;pr_brand_en&#39;: &#39;&#39;,
  &#39;pr_brand_th&#39;: &#39;&#39;,
  &#39;pr_online_name_en&#39;: &#39;ROSE SEESENCE BONBON&#39;,
  &#39;pr_online_name_th&#39;: &#39;ROSE SEESENCE BONBON&#39;,
  &#39;hema_name_en&#39;: &#39;ROSE SEESENCE BONBON&#39;,
  &#39;hema_name_th&#39;: &#39;ROSE SEESENCE BONBON&#39;,
  &#39;pr_name_en&#39;: &#39;ROSE SEESENCE BONBON&#39;,
  &#39;pr_name_th&#39;: &#39;บอล บอล กลิ่นกุหลาบ&#39;,
  &#39;pr_barcode&#39;: &#39;21932151&#39;,
  &#39;pr_barcode2&#39;: &#39;2193215&#39;,
  &#39;sort_weight&#39;: &#39;0&#39;}}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nd">@add_method</span><span class="p">(</span><span class="n">Browser</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">getLargeImage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sku</span><span class="p">:</span><span class="nb">str</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">Image</span><span class="p">:</span>
  <span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;http://d19oj5aeuefgv.cloudfront.net&#39;</span>
  <span class="k">return</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">sku</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">content</span><span class="p">),</span><span class="n">formats</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;PNG&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>
<span class="n">sku</span> <span class="o">=</span> <span class="s1">&#39;0189194&#39;</span>
<span class="n">browser</span><span class="o">.</span><span class="n">getLargeImage</span><span class="p">(</span><span class="n">sku</span><span class="p">)</span>
<span class="c1"># get image</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nd">@add_method</span><span class="p">(</span><span class="n">Browser</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">getSmallImage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sku</span><span class="p">:</span><span class="nb">str</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">Image</span><span class="p">:</span>
  <span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://d1vl5j0v241n75.cloudfront.net&#39;</span>
  <span class="k">return</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">sku</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">content</span><span class="p">),</span><span class="n">formats</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;PNG&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>
<span class="n">browser</span><span class="o">.</span><span class="n">getSmallImage</span><span class="p">(</span><span class="n">sku</span><span class="p">)</span>
<span class="c1">##small Image</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

</div>
 

